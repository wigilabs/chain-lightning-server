{"ast":null,"code":"import Cors from 'micro-cors';\nconst cors = Cors();\n\nconst superagent = require('superagent');\n\nconst handler = (req, res) => {\n  let events;\n  superagent.get('https://insights-api.newrelic.com/v1/accounts/2482859/query?nrql=SELECT+%60_raw%60%2C%60_sourcetype%60%2C%60source%60+FROM+splunkUpdateLogs%2C+splunkApacheAccess%2C+splunkApacheErrors%2C+splunkAuthLogs%2C+splunkHttp%2C+splunkKernel%2C+splunkSystemctl+WHERE+%60_raw%60+NOT+LIKE+%27%25CRON%25%27+LIMIT+5+').set('X-Query-Key', 'NRIQ-j7zJFckfarn9jsOB-nPscK5H6z0QCgHd').set('Accept', 'application/json').end((err, response) => {\n    events = JSON.parse(response.text).results[0].events;\n    let name1 = events[0]._sourcetype;\n    let eval1 = events[0]._raw;\n    let value1 = eval1.includes('not found or unable to stat') || eval1.includes('[:error]') || eval1.includes('deprecated') || eval1.includes('invalid') || eval1.includes('error') ? 0 : 1;\n    let name2 = events[1]._sourcetype;\n    let eval2 = events[1]._raw;\n    let value2 = eval2.includes('not found or unable to stat') || eval2.includes('[:error]') || eval2.includes('deprecated') || eval2.includes('invalid') || eval2.includes('error') ? 0 : 1;\n    let name3 = events[2]._sourcetype;\n    let eval3 = events[2]._raw;\n    let value3 = eval3.includes('not found or unable to stat') || eval3.includes('[:error]') || eval3.includes('deprecated') || eval3.includes('invalid') || eval3.includes('error') ? 0 : 1;\n    let name4 = events[3]._sourcetype;\n    let eval4 = events[3]._raw;\n    let value4 = eval4.includes('not found or unable to stat') || eval4.includes('[:error]') || eval4.includes('deprecated') || eval4.includes('invalid') || eval4.includes('error') ? 0 : 1;\n    let name5 = events[4]._sourcetype;\n    let eval5 = events[4]._raw;\n    let value5 = eval5.includes('not found or unable to stat') || eval5.includes('[:error]') || eval5.includes('deprecated') || eval5.includes('invalid') || eval5.includes('error') ? 0 : 1;\n    let parsed = [{\n      name: name1,\n      value: value1,\n      msg: eval1\n    }, {\n      name: name2,\n      value: value2,\n      msg: eval2\n    }, {\n      name: name3,\n      value: value3,\n      msg: eval3\n    }, {\n      name: name4,\n      value: value4,\n      msg: eval4\n    }, {\n      name: name5,\n      value: value5,\n      msg: eval5\n    }];\n    console.log(parsed);\n    return res.json(parsed);\n  });\n};\n\nexport default cors(handler);","map":{"version":3,"sources":["C:/Users/fsoler/Desktop/chain-lightning-server/pages/api/splunk-events.js"],"names":["Cors","cors","superagent","require","handler","req","res","events","get","set","end","err","response","JSON","parse","text","results","name1","_sourcetype","eval1","_raw","value1","includes","name2","eval2","value2","name3","eval3","value3","name4","eval4","value4","name5","eval5","value5","parsed","name","value","msg","console","log","json"],"mappings":"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","sourcesContent":["import Cors from 'micro-cors'\r\n\r\nconst cors = Cors()\r\n\r\nconst superagent = require('superagent');\r\nconst handler = (req, res) => {\r\n  let events\r\n  superagent\r\n    .get('https://insights-api.newrelic.com/v1/accounts/2482859/query?nrql=SELECT+%60_raw%60%2C%60_sourcetype%60%2C%60source%60+FROM+splunkUpdateLogs%2C+splunkApacheAccess%2C+splunkApacheErrors%2C+splunkAuthLogs%2C+splunkHttp%2C+splunkKernel%2C+splunkSystemctl+WHERE+%60_raw%60+NOT+LIKE+%27%25CRON%25%27+LIMIT+5+')\r\n    .set('X-Query-Key', 'NRIQ-j7zJFckfarn9jsOB-nPscK5H6z0QCgHd')\r\n    .set('Accept', 'application/json')\r\n    .end((err, response) => {\r\n      events = JSON.parse(response.text).results[0].events;\r\n      let name1=events[0]._sourcetype;\r\n      let eval1=events[0]._raw;\r\n      let value1=eval1.includes('not found or unable to stat') || eval1.includes('[:error]') || eval1.includes('deprecated') || eval1.includes('invalid') || eval1.includes('error') ? 0 : 1\r\n      let name2=events[1]._sourcetype;\r\n      let eval2=events[1]._raw;\r\n      let value2=eval2.includes('not found or unable to stat') || eval2.includes('[:error]') || eval2.includes('deprecated') || eval2.includes('invalid') || eval2.includes('error') ? 0 : 1\r\n      let name3=events[2]._sourcetype;\r\n      let eval3=events[2]._raw;\r\n      let value3=eval3.includes('not found or unable to stat') || eval3.includes('[:error]') || eval3.includes('deprecated') || eval3.includes('invalid') || eval3.includes('error') ? 0 : 1\r\n      let name4=events[3]._sourcetype;\r\n      let eval4=events[3]._raw;\r\n      let value4=eval4.includes('not found or unable to stat') || eval4.includes('[:error]') || eval4.includes('deprecated') || eval4.includes('invalid') || eval4.includes('error') ? 0 : 1\r\n      let name5=events[4]._sourcetype;\r\n      let eval5=events[4]._raw;\r\n      let value5=eval5.includes('not found or unable to stat') || eval5.includes('[:error]') || eval5.includes('deprecated') || eval5.includes('invalid') || eval5.includes('error') ? 0 : 1\r\n\r\n      let parsed = [\r\n        { name: name1,    value: value1,     msg: eval1 },\r\n        { name: name2,    value: value2,     msg: eval2 },\r\n        { name: name3,    value: value3,     msg: eval3 },\r\n        { name: name4,    value: value4,     msg: eval4 },\r\n        { name: name5,    value: value5,     msg: eval5 }\r\n      ]\r\n\r\n      console.log(parsed);\r\n      return res.json(parsed);\r\n    });\r\n};\r\n\r\nexport default cors(handler);\r\n"]},"metadata":{},"sourceType":"module"}
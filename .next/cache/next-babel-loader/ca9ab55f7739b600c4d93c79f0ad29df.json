{"ast":null,"code":"const superagent = require('superagent');\n\nconst handler = (req, res) => {\n  let events;\n  superagent.get('https://insights-api.newrelic.com/v1/accounts/2482859/query?nrql=SELECT+*+FROM+NagiosReport+SINCE+5+minutes+ago').set('X-Query-Key', 'NRIQ-j7zJFckfarn9jsOB-nPscK5H6z0QCgHd').set('Accept', 'application/json').end((err, response) => {\n    events = JSON.parse(response.text).results[0].events;\n    let dObj = events[0];\n    console.log('events: ', dObj);\n    let value_load = dObj['Current Load\\n'].includes('CRITICAL') ? 0 : 1;\n    let value_users = dObj['Current Users\\n'].includes('CRITICAL') ? 0 : 1;\n    let value_http = dObj['HTTP\\n'].includes('CRITICAL') ? 0 : 1;\n    let ping_value = dObj['PING\\n'].includes('CRITICAL') ? 0 : 1;\n    let root_partition = dObj['Root Partition\\n'].includes('CRITICAL') ? 0 : 1;\n    let ssh_value = dObj['SSH\\n'].includes('CRITICAL') ? 0 : 1;\n    let swap_value = dObj['Swap Usage\\n'].includes('CRITICAL') ? 0 : 1;\n    let total_value = dObj['Total Processes\\n'].includes('CRITICAL') ? 0 : 1;\n    events = [{\n      name: 'Current Load',\n      value: value_load\n    }, {\n      name: 'Current Users',\n      value: value_users\n    }, {\n      name: 'HTTP',\n      value: value_http\n    }, {\n      name: 'PING',\n      value: ping_value\n    }, {\n      name: 'Root Partition',\n      value: root_partition\n    }, {\n      name: 'SSH',\n      value: ssh_value\n    }, {\n      name: 'Swap Usage',\n      value: swap_value\n    }, {\n      name: 'Total Processes',\n      value: total_value\n    }];\n    return res.json(events);\n  });\n};\n\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}
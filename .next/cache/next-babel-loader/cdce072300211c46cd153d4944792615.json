{"ast":null,"code":"const superagent = require('superagent');\n\nconst handler = (req, res) => {\n  let events;\n  superagent.get('https://insights-api.newrelic.com/v1/accounts/2482859/query?nrql=SELECT%20description%20FROM%20ZabbixAgent,%20ZabbixHTTP,%20ZabbixSSH%20limit%203').set('X-Query-Key', 'NRIQ-j7zJFckfarn9jsOB-nPscK5H6z0QCgHd').set('Accept', 'application/json').end((err, response) => {\n    events = JSON.parse(response.text).results[0].events;\n    console.log('events: ', events);\n    var self = this;\n    events.forEach((element, index, array) => {\n      console.log(\"=====================================================================\");\n      console.log(index);\n      delete element.timestamp;\n      /*switch (index) {\r\n          case 0 : //ssh\r\n                element.timestamp=index\r\n          case 1 : //http\r\n                element.timestamp=index\r\n          case 2 : //agent\r\n                element.timestamp=index\r\n                     }*/\n\n      console.log(\"=====================================================================\");\n    });\n    /*events = [\r\n      {\r\n        name: 'SSH',\r\n        value: 1\r\n      }, \r\n      {\r\n        name: 'HTTP',\r\n        value: 1\r\n      }, \r\n      {\r\n        name: 'Agent',\r\n        value: 1\r\n      }\r\n            ]*/\n\n    return res.json(events);\n  });\n};\n\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}
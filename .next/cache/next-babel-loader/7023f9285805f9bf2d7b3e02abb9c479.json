{"ast":null,"code":"const superagent = require('superagent');\n\nconst handler = (req, res) => {\n  let events;\n  superagent.get('https://insights-api.newrelic.com/v1/accounts/2482859/query?nrql=SELECT%20description%20FROM%20ZabbixAgent,%20ZabbixHTTP,%20ZabbixSSH%20limit%203').set('X-Query-Key', 'NRIQ-j7zJFckfarn9jsOB-nPscK5H6z0QCgHd').set('Accept', 'application/json').end((err, response) => {\n    events = JSON.parse(response.text).results[0].events;\n    console.log('events: ', events);\n    let valueSSH = events[0].description.includes('is unreachable') ? 0 : 1;\n    let valueHTTP = events[1].description.includes('is unreachable') ? 0 : 1;\n    let valueHost = events[2].description.includes('is unreachable') ? 0 : 1;\n    console.log('valueSSH: ', valueSSH, 'msg:', events[0].description);\n    console.log('valueHTTP: ', valueHTTP, 'msg:', events[1].description);\n    console.log('valueHost: ', valueHost, 'msg:', events[2].description);\n    let ret = [{\n      name: 'SSH',\n      value: valueSSH,\n      msg: events[0].description\n    }, {\n      name: 'HTTP',\n      value: valueHTTP,\n      msg: events[1].description\n    }, {\n      name: 'Host',\n      value: valueHost,\n      msg: events[2].description\n    }];\n    return res.json(ret);\n  });\n};\n\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}